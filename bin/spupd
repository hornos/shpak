#!/bin/bash

# header ------------------------------------------------------------------------
. $(dirname ${0})/../lib/h.sh

# functions ---------------------------------------------------------------------
function local_update() {
  local _p_loc=""
  for _ip in shpak qcpak pypak; do
    _p_loc="${HOME}/${_ip}"
    if test -d ${_p_loc} ; then
      cd ${_p_loc}; getit
    fi
  done
  for _ip in shpak; do
    _p_loc="${HOME}/${_ip}"
    if test -d ${_p_loc} ; then
      chmod g-rwx "${_p_loc}"
      chmod o-rwx "${_p_loc}"
    fi
  done
}

function remote_update() {
  sshcmd -m "${_m}" -x "spupd"
}

function __usage() {
  echo "Usage: ${sp_g_bn} -m host"
}

# options -----------------------------------------------------------------------
_m="default"
if test $# -eq 0 ; then
  local_update
elif test $# -eq 1 ; then
  if test "${1}" = "-h" ; then
    __usage
    exit 1
  fi
  _m=${1}
  remote_update
else
  while getopts hm:c: o; do
    case "$o" in
      m) _m=$OPTARG;;
      h) __usage; exit 1;;
    esac
  done
  remote_update
fi
