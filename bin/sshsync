#!/bin/bash
# header ---------------------------------
. $(dirname ${0})/../lib/h.sh
sp_f_load ssh

function __usage() {
  echo "Usage: ${sp_g_bn} -m host -s <SOURCES>"
  exit 1
}

# options --------------------------------
_m="default"
__m="./.${sp_g_bn}"
_s="local .profile"

if test -r "${__m}" ; then
  _m=$(cat "${__m}")
fi

if test $# -eq 0 ; then
  __usage
  exit 1
elif test $# -eq 1 ; then
  if test "${1}" = "-h" ; then
    __usage
  fi
  _m="${1}"
else
  while getopts hm:s: o; do
    case "$o" in
      h) __usage;;
      m) _m=$OPTARG;;
      s) _s=$OPTARG;;
    esac
  done
fi

# main -----------------------------------
for i in ${_s} ; do
  sshpull -t3 -m${_m} -s${i}
done
